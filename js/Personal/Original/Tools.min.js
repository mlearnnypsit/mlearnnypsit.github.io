var $jscomp={scope:{},findInternal:function(a,c,d){a instanceof String&&(a=String(a));for(var b=a.length,e=0;e<b;e++){var l=a[e];if(c.call(d,l,e,a))return{i:e,v:l}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,c,d,b){if(c){d=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var e=a[b];e in d||(d[e]={});d=d[e]}a=a[a.length-1];b=d[a];c=c(b);c!=b&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6-impl","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,b={next:function(){if(d<a.length){var e=d++;return{value:c(e,a[e]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,d){return d})}},"es6","es3");var selectedText="",focusedInput,startIndex,shouldGoBackHide=0,notClicked=!0,file,colourTemplate='{\n   "Lecture": "#b0c4de",\n   "Practical": "#b0c4de",\n   "Tutorial": "#b0c4de",\n   "Remark": "#81c784",\n   "E-Learning": "#81c784",\n   "In Course Assessment": "#FA8072"\n}',selectOptions="{'Lecture','Practical','Tutorial','Remark','E-Learning','In Course Assessment'}";
$(function(){$(".carousel-control-prev").css("display","none");clearImportTextarea();$(window.document).on("focusout","#linkInput",checkAndDisplayAlert);if($(".inputDiv").addEventListener)$(".inputDiv").addEventListener("contextmenu",function(a){focusedInput=$(":focus");if("undefined"!=typeof window.getSelection){var c=window.getSelection();c.rangeCount&&(startIndex=c.focusOffset)}else"undefined"!=typeof document.selection&&"Text"==window.document.selection.type&&(startIndex=sel.focusOffset);window.getSelection?
selectedText=window.getSelection().toString():window.document.selection&&"Control"!=window.document.selection.type&&(selectedText=window.document.selection.createRange().text);selectedText&&($("#rightClickMenu").css("display","block"),$("#rightClickMenu").offset({left:a.pageX,top:a.pageY}),a.preventDefault())},!1);else $(document).on("contextmenu",".inputDiv",function(a){focusedInput=$(":focus");if("undefined"!=typeof window.getSelection){var c=window.getSelection();c.rangeCount&&(startIndex=c.focusOffset)}else"undefined"!=
typeof document.selection&&"Text"==document.selection.type&&(startIndex=sel.focusOffset);window.getSelection?selectedText=window.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(selectedText=document.selection.createRange().text);if(selectedText)return $("#rightClickMenu").css("display","block"),$("#rightClickMenu").offset({left:a.pageX,top:a.pageY}),(a||window.event).returnValue=!1});$(document).bind("click",function(a){$("#rightClickMenu").css("display","none")});
$(document).on("mouseover",".contentDivDivDraggableDiv",function(){$(this).stop(!0,!0);$(this).animate({opacity:1,queue:!1},300)});$(document).on("mouseout",".contentDivDivDraggableDiv",function(){$(this).animate({opacity:0},300)});$(document).on("change","#excelSelectInput",function(){$(this).hasClass("is-invalid")&&($(this).removeClass("is-invalid"),$(this).addClass("is-valid"))});$(document).on("change",".remapExcelSelectInput",function(){$(this).hasClass("is-invalid")&&($(this).removeClass("is-invalid"),
$(this).addClass("is-valid"))});contentEditableBr();$(document).on("click","#instructionPage,#instructionPageCloseBtn",function(){localStorage.setItem("instructionViewed",!0);localStorage.setItem("instructionViewedTime",(new Date).getTime());$("#instructionPage").fadeOut("slow");document.body.style.overflow="auto"});$(document).on("click","#instructionPageModal",function(a){a.stopPropagation()});document.body.style.cursor="auto"});
function goPage2(){$("#carousel").carousel("next");$("#carousel").carousel("pause");$(".carousel-control-prev").css("display","flex");shouldGoBackHide++}function goPage3(a){$("#carousel").carousel("next");$("#carousel").carousel("pause");$(".carousel-control-prev").css("display","flex");shouldGoBackHide++;$("#importPage3Preview").empty();$("#importPage3Preview").append(a)}
function goBack(){closeAlert();$("#carousel").carousel("prev");$("#carousel").carousel("pause");shouldGoBackHide--;0>=shouldGoBackHide&&$(".carousel-control-prev").css("display","none")}
function createNew(){$("#startupDiv").fadeOut();$("#masterDiv").css("overflow","auto");localStorage.instructionViewed?localStorage.instructionViewedTime&&6048E4<(new Date).getTime()-localStorage.instructionViewedTime&&(localStorage.removeItem("instructionViewed"),localStorage.removeItem("instructionViewedTime"),document.body.style.overflow="hidden",$("#instructionPageContent").children().first().css("display","block"),getInstructionGif(0),$("#instructionPage").fadeIn("slow")):(document.body.style.overflow=
"hidden",$("#instructionPageContent").children().first().css("display","block"),getInstructionGif(0),$("#instructionPage").fadeIn("slow"));$("#masterDiv").css("height","unset");$("#page1").empty();recreatePage1()}function closeAlert(){$(".alert").alert("close")}
function checkTextIsCorrect(){closeAlert();var a=document.createElement("div");a.className="alert alert-danger fade show";a.id="page2Error";a.setAttribute("role","alert");var c=document.createElement("p"),d=document.createElement("div"),b=document.createElement("button");b.className="close";b.setAttribute("type","button");b.setAttribute("data-dismiss","alert");b.setAttribute("aria-label","Close");var e=document.createElement("span");b.setAttribute("aria-hidden","true");b.innerHTML="&times;";b.appendChild(e);
d.appendChild(b);a.appendChild(c);a.appendChild(d);(d=$("#importTextarea").val().trim())?(b=$(document.createElement("div")),b.html(d),(d=b.find("#lessonPlanTemplate").html())?(d=d.trim(),0<d.length?(c=document.createElement("div"),c.id="lessonPlanTemplate",$(c).html(d),goPage3(c)):(c.appendChild(document.createTextNode("'id=#lessonPlanTemplate' div is empty. Make sure you entered/uploaded correctly")),$("#startupDivPage2 > div").prepend(a),$("#page2Error").slideDown(function(){a.style.display="flex"}))):
(c.appendChild(document.createTextNode("'id=#lessonPlanTemplate' div missing. Make sure you entered/uploaded correctly")),$("#startupDivPage2 > div").prepend(a),$("#page2Error").slideDown(function(){a.style.display="flex"}))):(c.appendChild(document.createTextNode("Make sure you entered/uploaded something")),$("#startupDivPage2 > div").prepend(a),$("#page2Error").slideDown(function(){a.style.display="flex"}))}
function fileMatchesLayout(a){closeAlert();var c=document.createElement("div");c.className="alert alert-danger fade show";c.id="page2Error";c.setAttribute("role","alert");var d=document.createElement("p"),b=document.createElement("div"),e=document.createElement("button");e.className="close";e.setAttribute("type","button");e.setAttribute("data-dismiss","alert");e.setAttribute("aria-label","Close");var l=document.createElement("span");e.setAttribute("aria-hidden","true");e.innerHTML="&times;";e.appendChild(l);
b.appendChild(e);c.appendChild(d);c.appendChild(b);if(a=a.trim())if(b=$(document.createElement("div")),b.html(a),a=b.find("#lessonPlanTemplate").html()){a=a.trim();if(0<a.length)return!0;d.appendChild(document.createTextNode("'id=#lessonPlanTemplate' div is empty. Make sure you entered/uploaded correctly"))}else d.appendChild(document.createTextNode("'id=#lessonPlanTemplate' div missing. Make sure you entered/uploaded correctly"));else d.appendChild(document.createTextNode("Make sure you entered/uploaded something"));
$("#startupDivPage2 > div").prepend(c);$("#page2Error").slideDown(function(){c.style.display="flex"});return!1}function hideStartupDiv(){$("#page2").empty();$("#page2").html($("#importPage3Preview").html());$("#importPage3Preview").empty();createNew()}
function allowDrop(a){window.File&&window.FileReader&&window.FileList&&window.Blob?($("#importTextarea").css("border","5px dashed grey"),$("#importTextarea").css("border-radius","20px"),a.preventDefault()):alert("Browser doesn't support drag and drop")}function removeDragCSS(){$("#importTextarea").css("border","");$("#importTextarea").css("border-radius","")}
function drop(a){a.preventDefault();removeDragCSS();$(".progress-bar").css("width","0%");$(".progress-bar")[0].classList.add("progress-bar-animated");$("#remappingDiv").collapse("hide");$("#remapIcon")[0].classList.add("fa-plus-square");$("#remapIcon")[0].classList.remove("fa-minus-square");a=a.dataTransfer?a.dataTransfer.files:a.target.files;if(!a[0])return!1;file=a[0];var c=new FileReader;file.type.match("text/plain")||file.type.match("text/html")?(c.onload=function(){var a=c.result;fileMatchesLayout(a)&&
($("#uploadedFileName").html(file.name),$("#importTextarea").val(a))},c.onprogress=function(a){a.lengthComputable&&(a=parseInt(a.loaded/a.total*100,10),$(".progress-bar").css("width",a+"%"),console.log(a))},c.onloadend=function(){$(".progress-bar")[0].classList.remove("progress-bar-animated")}):file.type.match("application/vnd.ms-excel")||file.type.match("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")?(showColumn(file),$("#excelBoxDiv").modal("show")):alert("Only .html, .txt & .xls(x) is the accepted file format");
c.readAsText(file)}
function showColumn(a){var c=new FileReader;c.onload=function(a){var b="";a=new Uint8Array(a.target.result);for(var c=a.byteLength,d=0;d<c;d++)b+=String.fromCharCode(a[d]);b=XLSX.read(b,{type:"binary",cellDates:!0,cellStyles:!0});$("#excelSelectInput").empty();$("#excelSelectInput2").empty();a=$("<option disabled selected>Please select your primary column</option>");$("#excelSelectInput").append(a);a=$("<option selected>Please select your secondary column</option>");$("#excelSelectInput2").append(a);b=
b.Sheets[b.SheetNames[0]];a=XLSX.utils.decode_range(b["!ref"]);$("#remappingDiv > .card-body").empty();for(c=a.s.c;c<=a.e.c;c++)if(d=XLSX.utils.encode_cell({c:c,r:0}),b[d]){var g=String(b[d].v),d=document.createElement("option");d.appendChild(document.createTextNode(g));d.value=c;var h=document.createElement("option");h.appendChild(document.createTextNode(g));h.value=c;$("#excelSelectInput").append(d);$("#excelSelectInput2").append(h);d=document.createElement("div");d.className="form-group";h=document.createElement("p");
h.appendChild(document.createTextNode("Table Header: "));h.className="remapColumnHeader";var z=document.createElement("p");z.appendChild(document.createTextNode(g));g=document.createElement("p");g.appendChild(document.createTextNode("Map to: "));g.className="remapColumnHeader";var t=document.createElement("select");t.className="custom-select remapExcelSelectInput";t.style.marginBottom="8px";var p=document.createElement("option");p.appendChild(document.createTextNode("Select an option"));p.selected=
!0;var n=document.createElement("option");n.appendChild(document.createTextNode("Lecture"));n.setAttribute("value","0");var k=document.createElement("option");k.appendChild(document.createTextNode("Practical"));k.setAttribute("value","1");var m=document.createElement("option");m.appendChild(document.createTextNode("Tutorial"));m.setAttribute("value","2");var r=document.createElement("option");r.appendChild(document.createTextNode("Remark"));r.setAttribute("value","3");var f=document.createElement("option");
f.appendChild(document.createTextNode("E-Learning"));f.setAttribute("value","4");var q=document.createElement("option");q.appendChild(document.createTextNode("In Course Assessment"));q.setAttribute("value","5");t.appendChild(p);t.appendChild(n);t.appendChild(k);t.appendChild(m);t.appendChild(r);t.appendChild(f);t.appendChild(q);d.appendChild(h);d.appendChild(z);d.appendChild(g);d.appendChild(t);$("#remappingDiv > .card-body").append(d)}};c.readAsArrayBuffer(a)}
function excelMoveToPage(a){switch(a){case 1:$("#excelPage1").fadeIn();$("#excelPage2").fadeOut();break;case 2:$("#excelSelectInput").val()&&0<=$("#excelSelectInput").val()?($("#excelPage3")[0].style.left="5%",$("#excelPage3")[0].style.top="10%",$("#excelPage3").css("position","absolute"),$("#excelPage1").fadeOut(),$("#excelPage2").fadeIn(),$("#excelPage3").fadeOut(),$(".modal-footer > button:nth-child(2)").css("display","none")):$("#excelSelectInput").addClass("is-invalid");$("#excelPage3 > .excelPopupButtonDiv > button").css("position",
"block");break;case 3:$("#excelPage2").fadeOut();$("#excelPage3").fadeIn(function(){$("#excelPage3")[0].style.left=0;$("#excelPage3")[0].style.top=0;$("#excelPage3").css("position","relative")});$(".modal-footer > button:nth-child(2)").css("display","block");break;default:alert("What? How is this possible... Stop it")}}
function startProcessingExcel(){var a;if($("#excelSelectInput").val()&&0<=$("#excelSelectInput").val()){var c=document.getElementById("customControlAutosizing").checked,d=document.createElement("div");d.id="lessonPlanTemplate";var b=document.createElement("p");b.appendChild(document.createTextNode("Instructors Details"));var e=document.createElement("div");b.className="bold underline";e.id="instructorsDetails";d.append(b);d.append(e);var l=$("#excelSelectInput").val(),g=$("#excelSelectInput2").val();
0<=l&&($("#uploadedFileName").html(file.name),b=new FileReader,b.onload=function(b){var e="";b=new Uint8Array(b.target.result);for(var h=b.byteLength,p=0;p<h;p++)e+=String.fromCharCode(b[p]);e=XLSX.read(e,{type:"binary",cellDates:!0,cellStyles:!0});e=e.Sheets[e.SheetNames[0]];b=a=b=XLSX.utils.decode_range(e["!ref"]);for(var h={lecture:[],practical:[],tutorial:[],remark:[],eLearning:[],iCA:[]},h=getRemapFromInput(h,l,g),p=[],n=b.s.c;n<=b.e.c;n++){var k=!1;for(keyValue in h)if(h.hasOwnProperty(keyValue))for(i=
0;i<h[keyValue].length;i++)if(parseInt(h[keyValue][i])===n){k=!0;break}k||(k=XLSX.utils.encode_cell({c:n,r:0}),e[k]&&(k=String(e[k].v).toLowerCase(),-1!==k.indexOf("lecture")?h.lecture.push(n):-1!==k.indexOf("practical")?h.practical.push(n):-1!==k.indexOf("tutorial")?h.tutorial.push(n):-1!==k.indexOf("remark")?h.remark.push(n):-1!==k.indexOf("e-learning")||-1!==k.indexOf("elearning")?h.eLearning.push(n):-1!==k.indexOf("ica")||-1!==k.indexOf("in course assessment")?h.iCA.push(n):n!==parseInt(l)&&n!==
parseInt(g)&&p.push(n)))}if(0<p.length){for(var n="Some columns could not be mapped automatically. Do you want to continue without mapping the Column(s): ",k=!0,m=0;m<p.length;m++){var r=XLSX.utils.encode_cell({c:p[m],r:0});e[r]&&(r=String(e[r].v),$("#remappingDiv > .card-body").children().eq(p[m]).find("select").addClass("is-invalid"),k?(n+=r,k=!1):n=m===p.length-1?n+(" & "+r+"?"):n+(", "+r))}if(!confirm(n))return!1}for(p=b.s.r+1;p<=b.e.r;p++)if(n=XLSX.utils.encode_cell({c:l,r:p}),e[n]){var f=e[n],
q=String(f.v),n=document.createElement("div"),k=document.createElement("div"),m=document.createElement("p"),r=document.createElement("p");n.className="lesson";k.className="lessonHeader";m.className="bold";r.className="em";f.l?isNaN(f.v)?$(m).html("<a href='"+f.l.Target+"' target='_blank'>"+f.v+"</a>"):$(m).html("<a href='"+f.l.Target+"' target='_blank'>Week "+f.v+"</a>"):isNaN(f.v)?$(m).html(q):$(m).html("Week "+q);g&&0<=g&&(f=checkIfMerged(e,g,p),f=f.found?XLSX.utils.encode_cell({c:f.sC,r:f.sR}):
XLSX.utils.encode_cell({c:g,r:p}),e[f]&&(f=e[f],q=String(f.v),f.l?isNaN(f.v)?$(r).html("<a href='"+f.l.Target+"' target='_blank'>"+f.v+"</a>"):$(r).html("<a href='"+f.l.Target+"' target='_blank'>Week "+f.v+"</a>"):isNaN(f.v)?$(r).html(q):$(r).html("Week "+q)));k.appendChild(m);k.appendChild(r);n.appendChild(k);k=checkIfMerged(e,l,p);if("row"===k.direction)for(k=k.eR-k.sR,m=b.s.c;m<=b.e.c;m++){if(r=null,m!=l&&m!=g){for(f=p;f<=p+k;f++)if(!(f>p&&"row"===checkIfMerged(e,m,p).direction)){var v,q=checkIfMerged(e,
m,f);v="column"===q.direction||"both"===q.direction?XLSX.utils.encode_cell({c:q.sC,r:q.sR}):XLSX.utils.encode_cell({c:m,r:f});if(e[v]){var u=getHeader(h,m),q=u.header,x=u.lecPrac,y=document.createElement("div"),w=document.createElement("p"),u=document.createElement("ul");y.className="lessonPlanContent";w.className="lessonPlanContentP";var A=e[v];v=String(A.v).trim().split("\n");var B="";if(A.l){v=A.v.trim().split("\n");for(var C=0;C<v.length;C++)B+="<li><a href='"+A.l.Target+"' target='_blank'>"+
v[C]+"</a></li>"}else for(A=0;A<v.length;A++)B+="<li>"+v[A]+"</li>";$(u).html(B);y.appendChild(w);y.appendChild(u);q.appendChild(x);q.appendChild(y);n.appendChild(q);c&&(r?f>p&&("row"===checkIfMerged(e,m,p).direction||"both"===checkIfMerged(e,m,p).direction)||(x=r.find(".lessonPlanContent > ul"),u=x.html()+u.innerHTML,$(x).html(u),$(q).remove()):r=$(q))}}d.appendChild(n)}}else{for(k=b.s.c;k<=b.e.c;k++)if(k!=l&&k!=g&&(m=checkIfMerged(e,k,p),x="column"===m.direction||"both"===m.direction||"row"===m.direction?
XLSX.utils.encode_cell({c:m.sC,r:m.sR}):XLSX.utils.encode_cell({c:k,r:p}),e[x])){r=getHeader(h,k);m=r.header;r=r.lecPrac;f=document.createElement("div");q=document.createElement("p");u=document.createElement("ul");f.className="lessonPlanContent";q.className="lessonPlanContentP";w=e[x];x=String(w.v).trim().split("\n");y="";if(w.l)for(x=w.v.trim().split("\n"),v=0;v<x.length;v++)y+="<li><a href='"+w.l.Target+"' target='_blank'>"+x[v]+"</a></li>";else for(w=0;w<x.length;w++)y+="<li>"+x[w]+"</li>";$(u).html(y);
f.appendChild(q);f.appendChild(u);m.appendChild(r);m.appendChild(f);n.appendChild(m)}d.appendChild(n)}}$("#importTextarea").val(d.outerHTML);$("#excelBoxDiv").modal("hide");$("#excelSelectInput").removeClass("is-valid");excelMoveToPage(2);excelMoveToPage(1)},b.onprogress=function(a){a.lengthComputable&&(a=parseInt(a.loaded/a.total*100,10),$(".progress-bar").css("width",a+"%"))},b.onloadend=function(){$(".progress-bar")[0].classList.remove("progress-bar-animated")},b.readAsArrayBuffer(file))}else $("#excelSelectInput").addClass("is-invalid")}
function getHeader(a,c){var d=document.createElement("div"),b=document.createElement("div"),e=document.createElement("p");b.appendChild(e);d.className="lecPracHeader";b.className="lecPracDiv";e.className="bold";var l=checkIfColumnsHeader(a,c);l?($(e).html(l),e=JSON.parse(colourTemplate),e[l]&&(b.style.background=e[l])):($(e).html("Lecture"),l=JSON.parse(colourTemplate),l.Lecture&&(b.style.background=l.Lecture));return{header:d,lecPrac:b}}
function checkIfColumnsHeader(a,c){var d=null,b;for(b in a)if(a.hasOwnProperty(b))for(i=0;i<a[b].length;i++)if(parseInt(a[b][i])===c)if("lecture"===b){d="Lecture";break}else if("practical"===b){d="Practical";break}else if("tutorial"===b){d="Tutorial";break}else if("remark"===b){d="Remark";break}else if("eLearning"===b){d="E-Learning";break}else if("iCA"===b){d="In Course Assessment";break}return d}
function getRemapFromInput(a,c,d){$("#remappingDiv > .card-body").children().each(function(b){if(b===c||b===d)return!1;switch(parseInt($(this).find("select").val())){case 0:a.lecture.push(b);break;case 1:a.practical.push(b);break;case 2:a.tutorial.push(b);break;case 3:a.remark.push(b);break;case 4:a.eLearning.push(b);break;case 5:a.iCA.push(b)}});return a}
function disableRemap(){$("#remappingDiv > .card-body").children().each(function(){var a=$(this).find("select");a[0].hasAttribute("disabled")&&a.removeAttr("disabled")});if($("#excelSelectInput").val()){var a=$("#remappingDiv > .card-body").children().eq($("#excelSelectInput").val()).find("select");a.attr("disabled","disabled");a[0].selectedIndex="0"}0!==$("#excelSelectInput2")[0].selectedIndex&&(a=$("#remappingDiv > .card-body").children().eq($("#excelSelectInput2").val()).find("select"),a.attr("disabled",
"disabled"),a[0].selectedIndex="0")}function changeRemapIcon(){$("#remapIcon").hasClass("fa-plus-square")?($("#remapIcon")[0].classList.add("fa-minus-square"),$("#remapIcon")[0].classList.remove("fa-plus-square")):($("#remapIcon")[0].classList.add("fa-plus-square"),$("#remapIcon")[0].classList.remove("fa-minus-square"))}
function checkIfMerged(a,c,d){if(a=a["!merges"]){a=Object.values(a);for(var b=0;b<a.length;b++){var e=a[b].s.c,l=a[b].e.c,g=a[b].s.r,h=a[b].e.r;if(c>=e&&c<=l&&d>=g&&d<=h){if(l>e)return h>g?{found:!0,sC:e,eC:l,sR:g,eR:h,direction:"both"}:{found:!0,sC:e,eC:l,sR:g,eR:h,direction:"column"};if(h>g)return{found:!0,sC:e,eC:l,sR:g,eR:h,direction:"row"}}}}return{found:!1,sC:null,eC:null,sR:null,eR:null,direction:"none"}}
function clearImportTextarea(){$("#inputGroupFile01").val(null);$("#uploadedFileName").html("Choose file");$("#importTextarea").val("");$(".progress-bar").css("width","0%")}
function makeSortable(){$(".mainSection").sortable({connectWith:".mainSection",items:".contentDivDiv",handle:".contentDivDivDraggableDiv",cancel:".inputDiv, textarea, input, button",update:function(){setActualValue()},axis:"y",cursor:"move",opacity:.5});$("#page1").sortable({items:".mainSection",cancel:":not('.draggableDiv')"})}function removeLessonContent(a){$(a).parent().fadeOut("swing",function(){$(a).parent().remove();recreatePage2()})}
function addLessonContent(a){var c=document.createElement("div"),d=document.createElement("div");d.className="contentDivDivDraggableDiv progress-bar-striped bg-success";d.style.opacity="0";var b=document.createElement("div");b.className="contentDivDivRight";var e=document.createElement("div"),l=document.createElement("p"),g=document.createElement("select"),h=document.createElement("input"),z=document.createElement("div"),t=document.createElement("div"),p=document.createElement("p"),n=document.createElement("div"),
k=document.createElement("input"),m=document.createElement("p"),r=document.createElement("div"),f=document.createElement("textarea"),q=document.createElement("button"),v=document.createElement("span");c.className="section contentDivDiv";e.className="leftDiv";g.className="inputDiv custom-select";h.className="form-control";z.className="flex rightDiv";t.className="page1Content";q.className="closeImg close";q.setAttribute("onclick","removeLessonContent(this)");q.setAttribute("type","button");q.setAttribute("aria-label",
"Close");v.setAttribute("aria-hidden","true");v.innerHTML="&times;";h.setAttribute("type","color");k.setAttribute("type","text");g.setAttribute("onchange","setActualColour(this)");h.setAttribute("onchange","setActualValue()");k.setAttribute("onkeyup","inputToDiv(this)");k.setAttribute("onkeydown","inputToDiv(this)");f.setAttribute("onkeyup","inputToDiv(this)");f.setAttribute("onkeydown","inputToDiv(this)");n.contentEditable="true";n.className="inputDiv contenteditableBr form-control";n.setAttribute("onkeyup",
"divToInput(this)");n.setAttribute("onkeydown","divToInput(this)");r.contentEditable="true";r.className="inputDiv form-control";r.setAttribute("onkeyup","divToInput(this)");r.setAttribute("onkeydown","divToInput(this)");$(r).html("<ul><li><br></li></ul>");$(r).keydown(function(a){if(8===a.keyCode&&"<ul><li><br></li></ul>"===$(this).html())return!1});var u=JSON.parse(colourTemplate);$(h).css("display","none");h.value=u.Lecture;$(k).css("display","none");$(f).css("display","none");$(f).text("<ul><li>>br></li></ul>");
u=document.createElement("option");u.appendChild(document.createTextNode("Lecture"));u.setAttribute("value","Lecture");var x=document.createElement("option");x.appendChild(document.createTextNode("Practical"));x.setAttribute("value","Practical");var y=document.createElement("option");y.appendChild(document.createTextNode("Tutorial"));y.setAttribute("value","Tutorial");var w=document.createElement("option");w.appendChild(document.createTextNode("Remark"));w.setAttribute("value","Remark");var A=document.createElement("option");
A.appendChild(document.createTextNode("E-Learning"));A.setAttribute("value","E-Learning");var B=document.createElement("option");B.appendChild(document.createTextNode("In Course Assessment"));B.setAttribute("value","In Course Assessment");g.appendChild(u);g.appendChild(x);g.appendChild(y);g.appendChild(w);g.appendChild(A);g.appendChild(B);l.appendChild(document.createTextNode("Lesson/ICA Type"));e.appendChild(l);e.appendChild(g);e.appendChild(h);p.appendChild(document.createTextNode("Title"));m.appendChild(document.createTextNode("Topics"));
t.appendChild(p);t.appendChild(n);t.appendChild(k);t.appendChild(m);t.appendChild(r);t.appendChild(f);z.appendChild(t);q.appendChild(v);b.appendChild(e);b.appendChild(z);c.appendChild(d);c.appendChild(b);c.appendChild(q);$(a).before(c);notClicked||($(".inputDiv").next().css("display","block"),$("textarea").css("display","block"));contentEditableBr();recreatePage2();makeSortable()}
function addLessonSection(a){var c=document.createElement("div"),d=document.createElement("div"),b=document.createElement("p"),e=document.createElement("div"),l=document.createElement("input"),g=document.createElement("p"),h=document.createElement("div"),z=document.createElement("input"),t=document.createElement("input"),p=document.createElement("div"),n=document.createElement("div");n.className="contentDivDivDraggableDiv progress-bar-striped bg-success";n.style.opacity="0";var k=document.createElement("div");
k.className="contentDivDivRight";var m=document.createElement("div"),r=document.createElement("p"),f=document.createElement("select"),q=document.createElement("input"),v=document.createElement("div"),u=document.createElement("div"),x=document.createElement("p"),y=document.createElement("div"),w=document.createElement("input"),A=document.createElement("p"),B=document.createElement("div");document.createElement("ul");var C=document.createElement("textarea"),D=document.createElement("button"),G=document.createElement("span"),
F=document.createElement("div"),I=document.createElement("i"),J=document.createElement("p"),E=document.createElement("button"),H=document.createElement("span");c.className="mainSection section";d.className="lessonTitle";p.className="section contentDivDiv";m.className="leftDiv";f.className="inputDiv custom-select";q.className="form-control";v.className="flex rightDiv";u.className="page1Content";y.className="contenteditableBr form-control";D.className="closeImg close";D.setAttribute("onclick","removeLessonContent(this)");
D.setAttribute("type","button");D.setAttribute("aria-label","Close");G.setAttribute("aria-hidden","true");G.innerHTML="&times;";J.appendChild(document.createTextNode("Add New Lesson/ICA"));I.className="fas fa-plus-circle";F.className="addLessonContent";F.setAttribute("onclick","addLessonContent(this)");E.className="closeImg close";E.setAttribute("onclick","removeLessonContent(this)");E.setAttribute("type","button");E.setAttribute("aria-label","Close");H.setAttribute("aria-hidden","true");H.innerHTML=
"&times;";l.setAttribute("type","text");l.className="lessonTitleInput form-control";z.setAttribute("type","text");z.className="lessonSubtitleInput form-control";t.className="form-control showAllInput";t.setAttribute("onchange","setActualValue()");t.setAttribute("type","color");$(t).val("#87cefa");q.setAttribute("type","color");w.setAttribute("type","text");l.setAttribute("onkeyup","inputToDiv(this)");l.setAttribute("onkeydown","inputToDiv(this)");z.setAttribute("onkeyup","inputToDiv(this)");z.setAttribute("onkeydown",
"inputToDiv(this)");f.setAttribute("onchange","setActualColour(this)");q.setAttribute("onchange","setActualValue()");w.setAttribute("onkeyup","inputToDiv(this)");w.setAttribute("onkeydown","inputToDiv(this)");C.setAttribute("onkeyup","inputToDiv(this)");C.setAttribute("onkeydown","inputToDiv(this)");e.contentEditable="true";e.className="inputDiv contenteditableBr form-control";e.setAttribute("onkeyup","divToInput(this)");e.setAttribute("onkeydown","divToInput(this)");h.contentEditable="true";h.className=
"inputDiv contenteditableBr form-control";h.setAttribute("onkeyup","divToInput(this)");h.setAttribute("onkeydown","divToInput(this)");y.contentEditable="true";y.className="inputDiv contenteditableBr form-control";y.setAttribute("onkeyup","divToInput(this)");y.setAttribute("onkeydown","divToInput(this)");B.contentEditable="true";B.className="inputDiv form-control";B.setAttribute("onkeyup","divToInput(this)");B.setAttribute("onkeydown","divToInput(this)");$(B).html("<ul><li><br></li></ul>");$(B).keydown(function(a){if(8===
a.keyCode&&"<ul><li><br></li></ul>"===$(this).html())return!1});var K=JSON.parse(colourTemplate);$(l).css("display","none");$(z).css("display","none");$(t).css("display","none");$(q).css("display","none");q.value=K.Lecture;$(w).css("display","none");$(C).css("display","none");b.appendChild(document.createTextNode("Lesson Title"));g.appendChild(document.createTextNode("Subtitle Title"));d.appendChild(b);d.appendChild(e);d.appendChild(l);d.appendChild(g);d.appendChild(h);d.appendChild(z);d.appendChild(t);
b=document.createElement("option");b.appendChild(document.createTextNode("Lecture"));b.setAttribute("value","Lecture");e=document.createElement("option");e.appendChild(document.createTextNode("Practical"));e.setAttribute("value","Practical");l=document.createElement("option");l.appendChild(document.createTextNode("Tutorial"));l.setAttribute("value","Tutorial");g=document.createElement("option");g.appendChild(document.createTextNode("Remark"));g.setAttribute("value","Remark");h=document.createElement("option");
h.appendChild(document.createTextNode("E-Learning"));h.setAttribute("value","E-Learning");z=document.createElement("option");z.appendChild(document.createTextNode("In Course Assessment"));z.setAttribute("value","In Course Assessment");f.appendChild(b);f.appendChild(e);f.appendChild(l);f.appendChild(g);f.appendChild(h);f.appendChild(z);r.appendChild(document.createTextNode("Lesson/ICA Type"));m.appendChild(r);m.appendChild(f);m.appendChild(q);x.appendChild(document.createTextNode("Title"));A.appendChild(document.createTextNode("Topics"));
u.appendChild(x);u.appendChild(y);u.appendChild(w);u.appendChild(A);u.appendChild(B);u.appendChild(C);v.appendChild(u);D.appendChild(G);k.appendChild(m);k.appendChild(v);p.appendChild(n);p.appendChild(k);p.appendChild(D);F.appendChild(I);F.appendChild(J);E.appendChild(H);c.appendChild(d);c.appendChild(p);c.appendChild(F);c.appendChild(E);$(a).before(c);notClicked||($(".inputDiv").next().css("display","block"),$("textarea").css("display","block"),$(".showAllInput").css("display","block"));contentEditableBr();
recreatePage2();makeSortable()}
function recreatePage1(){$("#page1").empty();var a=document.createElement("div"),c=document.createElement("p");c.appendChild(document.createTextNode("Instructors Details"));c.className="bold underline";var d=document.createElement("div");d.contentEditable="true";d.className="inputDiv form-control";d.setAttribute("onkeyup","divToInput(this)");d.setAttribute("onkeydown","divToInput(this)");var b=document.createElement("textarea");b.id="paragraphTextarea";b.setAttribute("onkeyup","inputToDiv(this)");
b.setAttribute("onkeydown","inputToDiv(this)");$(b).css("display","none");var e=$("#page2 > #lessonPlanTemplate > #instructorsDetails").html().trim().replace(/\t/g,"");$(d).html(e);$(d).keydown(function(a){if(8===a.keyCode&&"<p><br></p>"===$(this).html())return!1});$(b).val(e);a.appendChild(c);a.appendChild(d);a.appendChild(b);$("#page1").append(a);$(".lesson").each(function(){var a=document.createElement("div");a.className="mainSection section";var b=document.createElement("div");b.className="lessonTitle";
var d=document.createElement("p");d.appendChild(document.createTextNode("Lesson Title"));var c=document.createElement("div");c.contentEditable="true";c.className="inputDiv contenteditableBr form-control";c.setAttribute("onkeyup","divToInput(this)");c.setAttribute("onkeydown","divToInput(this)");var e=document.createElement("input");e.setAttribute("onkeyup","inputToDiv(this)");e.setAttribute("onkeydown","inputToDiv(this)");e.className="lessonTitleInput form-control";$(c).html($(this).find(".lessonHeader").children().eq(0).html());
$(e).val($(this).find(".lessonHeader").children().eq(0).html());$(e).css("display","none");var k=document.createElement("p");k.appendChild(document.createTextNode("Lesson Subtitle"));var l=document.createElement("div");l.contentEditable="true";l.className="inputDiv contenteditableBr form-control";l.setAttribute("onkeyup","divToInput(this)");l.setAttribute("onkeydown","divToInput(this)");var g=document.createElement("input");g.setAttribute("onkeyup","inputToDiv(this)");g.setAttribute("onkeydown","inputToDiv(this)");
g.className="lessonSubtitleInput form-control";$(l).html($(this).find(".lessonHeader").children().eq(1).html());$(g).val($(this).find(".lessonHeader").children().eq(1).text());$(g).css("display","none");var f=document.createElement("input");f.setAttribute("onchange","setActualValue()");f.setAttribute("type","color");f.className="form-control showAllInput";$(f).css("display","none");var q=$(this).find(".lessonHeader").css("background-color");$(f).val(rgb2hex(q));b.appendChild(d);b.appendChild(c);b.appendChild(e);
b.appendChild(k);b.appendChild(l);b.appendChild(g);b.appendChild(f);a.appendChild(b);$(this).find(".lecPracHeader").each(function(){var b=document.createElement("div");b.className="section contentDivDiv";var c=document.createElement("div");c.className="contentDivDivDraggableDiv progress-bar-striped bg-success";c.style.opacity="0";var d=document.createElement("div");d.className="contentDivDivRight";var e=document.createElement("div");e.className="leftDiv";var l=document.createElement("p");l.appendChild(document.createTextNode("Lesson/ICA Type"));
var f=document.createElement("select");f.setAttribute("onchange","setActualColour(this)");f.className="inputDiv custom-select";var g=document.createElement("option");g.appendChild(document.createTextNode("Lecture"));g.setAttribute("value","Lecture");var k=document.createElement("option");k.appendChild(document.createTextNode("Practical"));k.setAttribute("value","Practical");var h=document.createElement("option");h.appendChild(document.createTextNode("Tutorial"));h.setAttribute("value","Tutorial");
var n=document.createElement("option");n.appendChild(document.createTextNode("Remark"));n.setAttribute("value","Remark");var m=document.createElement("option");m.appendChild(document.createTextNode("E-Learning"));m.setAttribute("value","E-Learning");var p=document.createElement("option");p.appendChild(document.createTextNode("In Course Assessment"));p.setAttribute("value","In Course Assessment");f.appendChild(g);f.appendChild(k);f.appendChild(h);f.appendChild(n);f.appendChild(m);f.appendChild(p);
$(f).val($(this).find(".lecPracDiv :first-child").text());g=document.createElement("input");g.setAttribute("onchange","setActualValue()");g.setAttribute("type","color");g.className="form-control";$(g).css("display","none");k=$(this).find(".lecPracDiv").css("background-color");$(g).val(rgb2hex(k));e.appendChild(l);e.appendChild(f);e.appendChild(g);l=document.createElement("div");l.className="flex rightDiv";f=document.createElement("div");f.className="page1Content";g=document.createElement("p");g.appendChild(document.createTextNode("Title"));
k=document.createElement("div");k.contentEditable="true";k.className="inputDiv contenteditableBr form-control";k.setAttribute("onkeyup","divToInput(this)");k.setAttribute("onkeydown","divToInput(this)");h=document.createElement("input");h.setAttribute("onkeyup","inputToDiv(this)");h.setAttribute("onkeydown","inputToDiv(this))");h.setAttribute("type","text");$(k).html($(this).find(".lessonPlanContent .lessonPlanContentP").html());$(h).val($(this).find(".lessonPlanContent .lessonPlanContentP").html());
$(h).css("display","none");n=document.createElement("p");n.appendChild(document.createTextNode("Topics"));m=document.createElement("div");m.contentEditable="true";m.className="inputDiv form-control";m.setAttribute("onkeyup","divToInput(this)");m.setAttribute("onkeydown","divToInput(this)");p=document.createElement("textarea");p.setAttribute("onkeyup","inputToDiv(this)");p.setAttribute("onkeydown","inputToDiv(this)");$(p).css("display","none");var q=$(this).find(".lessonPlanContent ul")[0].outerHTML.trim().replace(/\t/g,
"");$(m).html(q);$(p).val(q);$(m).keydown(function(a){if(8===a.keyCode&&"<ul><li><br></li></ul>"===$(this).html())return!1});f.appendChild(g);f.appendChild(k);f.appendChild(h);f.appendChild(n);f.appendChild(m);f.appendChild(p);l.appendChild(f);f=document.createElement("button");f.className="closeImg close";f.setAttribute("onclick","removeLessonContent(this)");f.setAttribute("type","button");f.setAttribute("aria-label","Close");g=document.createElement("span");g.setAttribute("aria-hidden","true");
g.innerHTML="&times;";f.appendChild(g);d.appendChild(e);d.appendChild(l);b.appendChild(c);b.appendChild(d);b.appendChild(f);a.appendChild(b)});b=document.createElement("div");b.className="addLessonContent";d=document.createElement("p");d.appendChild(document.createTextNode("Add New Lesson/ICA"));c=document.createElement("i");e=document.createElement("button");e.className="closeImg close";k=document.createElement("span");b.setAttribute("onclick","addLessonContent(this)");c.className="fas fa-plus-circle";
e.setAttribute("onclick","removeLessonContent(this)");e.setAttribute("type","button");e.setAttribute("aria-label","Close");k.setAttribute("aria-hidden","true");k.innerHTML="&times;";e.appendChild(k);b.appendChild(c);b.appendChild(d);a.appendChild(b);a.appendChild(e);$("#page1").append(a)});a=document.createElement("div");c=document.createElement("i");d=document.createElement("p");a.id="addLessonSection";a.className="addLessonContent";a.setAttribute("onclick","addLessonSection(this)");a.style.color=
"white";c.className="fas fa-plus-circle";d.appendChild(document.createTextNode("Add New Lesson"));a.appendChild(c);a.appendChild(d);c=document.createElement("div");c.className="footerSection";d=document.createElement("p");d.appendChild(document.createTextNode("Footnote"));b=document.createElement("div");b.contentEditable="true";b.className="inputDiv contenteditableBr form-control";b.setAttribute("onkeyup","divToInput(this)");b.setAttribute("onkeydown","divToInput(this)");e=document.createElement("input");
e.setAttribute("type","text");e.setAttribute("onkeyup","inputToDiv(this)");e.setAttribute("onkeydown","inputToDiv(this)");e.id="lessonPlanFooter";$(b).html($("#lessonPlanTemplate .sub").html());$(e).val($("#lessonPlanTemplate .sub").html());$(e).css("display","none");c.appendChild(d);c.appendChild(b);c.appendChild(e);d=document.createElement("br");b=document.createElement("div");b.style.display="flex";b.style.flexDirection="column";e=document.createElement("button");e.appendChild(document.createTextNode("Generate HTML for BlackBoard"));
e.setAttribute("onclick","generateHTML()");e.className="btn btn-primary";var l=document.createElement("button");l.appendChild(document.createTextNode("Save As HTML (For Reimport)"));l.setAttribute("onclick","saveHTMLFile()");l.className="btn btn-secondary";var g=document.createElement("button");g.appendChild(document.createTextNode("Show All Hidden HTML"));g.setAttribute("onclick","showAllInput(this)");g.className="btn btn-secondary";b.appendChild(e);b.appendChild(l);b.appendChild(g);e=document.getElementById("page1");
e.appendChild(a);e.appendChild(c);e.appendChild(d);e.appendChild(b);contentEditableBr();makeSortable()}
function recreatePage2(){$("#page2").empty();var a=document.createElement("div");a.id="lessonPlanTemplate";var c=document.createElement("p");c.appendChild(document.createTextNode("Instructors Details"));var d=document.createElement("div"),b=$("#paragraphTextarea").val();$(d).html(b);c.className="bold underline";d.id="instructorsDetails";a.append(c);a.append(d);$(".mainSection").each(function(){var b=document.createElement("div"),c=document.createElement("div");c.style.backgroundColor=$(this).find(".lessonTitle > :last-child").val();
var d=document.createElement("p");$(d).html($(this).find(".lessonTitleInput").val());var h=document.createElement("p");$(h).html($(this).find(".lessonSubtitleInput").val());b.className="lesson";c.className="lessonHeader";d.className="bold";h.className="em";c.appendChild(d);c.appendChild(h);b.appendChild(c);$(this).find(".contentDivDiv").each(function(){var a=document.createElement("div"),c=document.createElement("div"),d=document.createElement("p");$(c).css("background-color",$(this).find(".leftDiv input").val());
$(d).html($(this).find(".leftDiv :nth-child(2)").val());c.appendChild(d);var e=document.createElement("div"),g=document.createElement("p");$(g).html($(this).find(".rightDiv .page1Content .inputDiv").eq(0).html());var h=$(this).find(".rightDiv .page1Content .inputDiv").eq(1).html();$(e).html(h);a.className="lecPracHeader";c.className="lecPracDiv";d.className="bold";e.className="lessonPlanContent";g.className="lessonPlanContentP";$(e).prepend(g);a.appendChild(c);a.appendChild(e);b.appendChild(a)});
a.append(b)});c=document.createElement("p");$(c).html($("#lessonPlanFooter").val());c.className="sub";a.append(c);$("#page2").append(a)}function setInputValue(){recreatePage1()}function setActualValue(){recreatePage2()}function setActualColour(a){var c=a.value,d=JSON.parse(colourTemplate);d[c]&&$(a).next().val(d[c]);recreatePage2()}function generateHTML(){$("#popupDiv").modal("show");$("#popup .modal-body textarea").val($("#page2").html().trim())}
function closePopup(){$("#popupDiv").modal("hide");$("#popup .generateHTMLRedText").css("display","none")}function copyToClipboard(){$("#popup .modal-body textarea")[0].select();document.execCommand("copy");$("#popup .generateHTMLRedText").css("display","block")}function copyCommand(){var a=document.createElement("textarea");$(a).text(selectedText);$("#masterDiv").append(a);$(a)[0].select();document.execCommand("copy");$(a).remove()}
function checkOverlapLink(a){a=htmlEncode(a);var c=focusedInput;startIndex=c.next().val().indexOf(a);var d=escape("<a href="),b=escape("</a>");if((new RegExp("("+d+").*("+escape(a)+").*("+b+")")).test(escape(c.next().val())))return alert("Error! You already made this a link."),!1;if(-1!==startIndex)return!0;alert("Error! Make sure the text selected is not overlapping with another link.");return!1}
function promptLink(){0<selectedText.length&&checkOverlapLink(selectedText)&&($("#linkInput").val("https://"),$("#linkBoxOptions").text("Webpage"),$("#linkBoxDiv").modal("show"))}function hideLinkBox(){$("#linkBoxDiv").modal("hide");changeInputBoxSelection(1)}function hideExcelBox(){$("#excelSelectInput").removeClass("is-invalid");$("#excelSelectInput").removeClass("is-valid");$("#inputGroupFile01").val(null);$("#uploadedFileName").html("Choose file");$("#excelBoxDiv").modal("hide")}
function changeInputBoxSelection(a){$(".dropdown-menu > .active.dropdown-item")[0].classList.remove("active");var c=$("#linkBoxOptions"),d=$("#linkInput");switch(a){case 1:c.text("Webpage");d[0].setAttribute("placeholder","https://");d.val("https://");$(".dropdown-menu > a:first-child")[0].classList.add("active");break;case 2:c.text("Email");d[0].setAttribute("placeholder","example@nyp.edu.sg");d.val("");/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(selectedText)&&
d.val(htmlEncode(selectedText));$(".dropdown-menu > a:nth-child(2)")[0].classList.add("active");break;case 3:c.text("Javascript"),d[0].setAttribute("placeholder","alert('Hello')"),d.val(""),$(".dropdown-menu > a:nth-child(4)")[0].classList.add("active")}}
function checkAndDisplayAlert(){if($("#linkInput").val()){var a=document.createElement("div");a.className="alert alert-warning fade show";a.id="linkBoxAlertError";a.setAttribute("role","alert");var c=document.createElement("p"),d=document.createElement("div"),b=document.createElement("button");b.className="close";b.setAttribute("type","button");b.setAttribute("data-dismiss","alert");b.setAttribute("aria-label","Close");var e=document.createElement("span");b.setAttribute("aria-hidden","true");b.innerHTML=
"&times;";b.appendChild(e);d.appendChild(b);a.appendChild(c);a.appendChild(d);d=$("#linkInput").val();b=$("#linkBoxOptions").text();"Webpage"===b?/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/.test(d)?closeAlert():(closeAlert(),c.appendChild(document.createTextNode("The URL entered does not match the format.")),$("#linkBox > .modal-content > .modal-body").prepend(a)):"Email"===b&&(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(d)?
closeAlert():(closeAlert(),c.appendChild(document.createTextNode("The email entered does not match the format.")),$("#linkBox > .modal-content > .modal-body").prepend(a)))}}function whichLinkSelection(){var a=$("#linkBoxOptions").text();if("Webpage"===a)return"";if("Email"===a)return"mailto:";if("Javascript"===a)return"javascript:";alert("Unexpected error");return null}
function convertToLink(){closeAlert();var a=document.createElement("div");a.className="alert alert-danger fade show";a.id="linkBoxAlertError";a.setAttribute("role","alert");var c=document.createElement("p"),d=document.createElement("div"),b=document.createElement("button");b.className="close";b.setAttribute("type","button");b.setAttribute("data-dismiss","alert");b.setAttribute("aria-label","Close");var e=document.createElement("span");b.setAttribute("aria-hidden","true");b.innerHTML="&times;";b.appendChild(e);
d.appendChild(b);a.appendChild(c);a.appendChild(d);if(d=$("#linkInput").val()){if(""===whichLinkSelection()){if(!/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/.test(d)&&!confirm("The URL entered does not match the format. Do you want to continue?"))return c.appendChild(document.createTextNode("The URL entered does not match the format.")),a.className="alert alert-warning fade show",$("#linkBox > .modal-content > .modal-body").prepend(a),!1}else if("mailto:"===
whichLinkSelection()&&!/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(selectedText)&&!confirm("The email entered does not match the format. Do you want to continue?"))return c.appendChild(document.createTextNode("The email entered does not match the format.")),a.className="alert alert-warning fade show",$("#linkBox > .modal-content > .modal-body").prepend(a),!1;var b=htmlEncode(selectedText),
l=focusedInput,e=l.html(),d=whichLinkSelection()?"<a href='"+whichLinkSelection()+$("#linkInput").val()+"' target='_blank'>"+b+"</a>":"<a href='"+$("#linkInput").val()+"' target='_blank'>"+b+"</a>";startIndex=l.next().val().indexOf(b);var g=escape("<a href="),h=escape("</a>");(new RegExp("("+g+").*("+escape(b)+").*("+h+")")).test(escape(l.next().val()))?(c.appendChild(document.createTextNode("Error! You already made this a link.")),$("#linkBox > .modal-content > .modal-body").prepend(a)):-1!==startIndex?
(a=e.substring(0,startIndex),c=e.substring(startIndex+b.length),a=a+d+c,focusedInput.next().val(a),focusedInput.html(focusedInput.next().val()),setActualValue()):(c.appendChild(document.createTextNode("Error! Make sure the text selected is not overlapping with another link.")),$("#linkBox > .modal-content > .modal-body").prepend(a));hideLinkBox()}else c.appendChild(document.createTextNode("Please enter a link.")),$("#linkBox > .modal-content > .modal-body").prepend(a)}
function divToInput(a){$(a).next().val(a.innerHTML);setActualValue()}function inputToDiv(a){$(a).prev().html(a.value);setActualValue()}
function saveHTMLFile(){try{new Blob;var a=prompt("Please enter filename:","BlackBoard Lesson Plan");if(a){var c=document.getElementById("lessonPlanTemplate").outerHTML.toString(),d=new Blob([c],{type:"text/html;charset=utf-8"});saveAs(d,a+".html")}}catch(e){a=document.createElement("div");a.style.position="fixed";a.style.top="0";a.style.left="0";a.style.width="100%";a.style.height="100%";a.style.backgroundColor="rgba(25,25,25,0.6)";a.id="saveFileAlertBackground";c=document.createElement("div");c.className=
"alert alert-danger alert-dismissible fade show";c.setAttribute("role","alert");c.style.position="absolute";c.style.top="40%";c.style.left="20%";c.style.width="60%";c.style.height="20%";d=document.createElement("p");d.innerHTML="<strong>File saving not supported</strong><br>To save the file, press <kbd><kbd>ctrl</kbd> + <kbd>s</kbd></kbd>";var b=document.createElement("button");b.setAttribute("data-dismiss","alert");b.setAttribute("aria-label","close");b.appendChild(document.createTextNode("Close"));
b.className="btn btn-primary";b.onclick=function(){$("#saveFileAlertBackground").remove()};c.appendChild(d);c.appendChild(b);a.appendChild(c);$("#masterDiv").append(a);console.log("Error message: "+e)}}
function showAllInput(a){notClicked?($(".inputDiv").next().css("display","block"),$("textarea:not(#popup textarea)").css("display","block"),$(".showAllInput").css("display","block"),a.innerHTML="Hide All Hidden HTML",notClicked=!1):($(".inputDiv").next().css("display","none"),$("textarea:not(#popup textarea)").css("display","none"),$(".showAllInput").css("display","none"),a.innerHTML="Show All Hidden HTML",notClicked=!0)}
function checkImage(){for(i=0;i<$("#instructionPageContent > .instructionPageContentContents").length;i++)getInstructionGif(i)}
function getInstructionGif(a){var c=$("#instructionPageContent > .instructionPageContentContents").eq(a).find("img")[0],d,b,e,l,g,h;$(window).width()>$(window).height()?(d="images/LessonPlanGenerator/Desktop/addNewICA.gif",b="images/LessonPlanGenerator/Desktop/addNewLesson.gif",e="images/LessonPlanGenerator/Desktop/removingLesson.gif",l="images/LessonPlanGenerator/Desktop/sorting.gif",g="images/LessonPlanGenerator/Desktop/link.gif",h="images/LessonPlanGenerator/Desktop/changingColour.gif"):(d="images/LessonPlanGenerator/Mobile/M-addNewICA.gif",
b="images/LessonPlanGenerator/Mobile/M-addNewLesson.gif",e="images/LessonPlanGenerator/Mobile/M-removingLesson.gif",l="images/LessonPlanGenerator/Mobile/M-sorting.gif",g="images/LessonPlanGenerator/Mobile/M-link.gif",h="images/LessonPlanGenerator/Mobile/M-changingColour.gif");switch(a){case 0:c.src=d;break;case 1:c.src=b;break;case 2:c.src=e;break;case 3:c.src=l;break;case 4:c.src=g;break;case 5:c.src=h}}
function instructionPageButtonDivNext(a){var c=document.getElementById("instructionPageContent").children;for(i=0;i<c.length;i++){var d=c[i];i===c.length-2&&($(a).prev().text("Finish"),$(a).prev()[0].className="btn btn-primary",$(a).remove());if("block"===$(d).css("display")){getInstructionGif(i+1);d.style.display="none";c[i+1].style.display="block";break}}}function checkEnterKey(a){if(13===a.keyCode)return document.execCommand("insertHTML",!1,"<br /><br />"),!1}
function contentEditableBr(){$(document).off("keydown",".contenteditableBr",checkEnterKey);$(document).on("keydown",".contenteditableBr",checkEnterKey)}function selectAll(a){a.setSelectionRange(0,a.value.length)}var hexDigits="0123456789abcdef".split("");function rgb2hex(a){return(a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/))?"#"+hex(a[1])+hex(a[2])+hex(a[3]):"#000000"}function hex(a){return isNaN(a)?"00":hexDigits[(a-a%16)/16]+hexDigits[a%16]}
function htmlEncode(a){return $("<div/>").text(a).html()}function htmlDecode(a){return a.replace(/&#(\d+);?/g,function(a,d){return String.fromCharCode(d)})};
